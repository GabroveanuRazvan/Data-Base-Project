create table CARTE(
    ID_CARTE NUMBER(5),
    TITLU_CARTE VARCHAR(50),
    ID_EXEMPLAR NUMBER(6) CONSTRAINT NN_CARTE_ID_EXEMPLAR NOT NULL
    
    CONSTRAINT PK_CARTE PRIMARY KEY(ID_CARTE)
);


CREATE TABLE AUTOR (
    ID_AUTOR NUMBER(4),
    NUME_AUTOR VARCHAR2(20) CONSTRAINT NN_NUME_AUTOR NOT NULL,
    PRENUME_AUTOR VARCHAR2(30),
    
    CONSTRAINT PK_AUTOR PRIMARY KEY(ID_AUTOR),
    CONSTRAINT U_NUME_PRENUME_AUTOR UNIQUE(NUME_AUTOR, PRENUME_AUTOR)
);

CREATE TABLE CATEGORIE (
    ID_CATEGORIE NUMBER(3),
    NUME_CATEGORIE VARCHAR2(20) CONSTRAINT NN_NUME_CATEGORIE NOT NULL,

    CONSTRAINT PK_CATEGORIE PRIMARY KEY(ID_CATEGORIE)
);

CREATE TABLE EDITURA(
    ID_EDITURA NUMBER(3),
    NUME_EDITURA VARCHAR2(30) CONSTRAINT NN_NUME_EDITURA NOT NULL,
     
    CONSTRAINT PK_EDITURA PRIMARY KEY(ID_EDITURA)
);

CREATE TABLE CARTE(
    ID_CARTE NUMBER(5),
    TITLU_CARTE VARCHAR2(50) CONSTRAINT NN_TITLU_CARTE NOT NULL,
    
    CONSTRAINT PK_CARTE PRIMARY KEY(ID_CARTE)
);

CREATE TABLE BIBLIOTECAR(
    ID_BIBLIOTECAR NUMBER(3),
    NUME_BIBLIOTECAR VARCHAR2(20) CONSTRAINT NN_NUME_BIBLIOTECAR NOT NULL,
    PRENUME_BIBLIOTECAR VARCHAR2(30), 
    NUMAR_TELEFON_BIBLIOTECAR CHAR(10),
    EMAIL_BIBLIOTECAR VARCHAR2(50),
    
    CONSTRAINT PK_BIBLIOTECAR PRIMARY KEY(ID_BIBLIOTECAR),
    CONSTRAINT U_NUME_PRENUME_BIBLIOTECAR UNIQUE(NUME_BIBLIOTECAR, PRENUME_BIBLIOTECAR)
);

CREATE TABLE CITITOR(
    ID_CITITOR NUMBER(3),
    NUME_CITITOR VARCHAR2(20) CONSTRAINT NN_NUME_CITITOR NOT NULL,
    PRENUME_CITITOR VARCHAR2(30), 
    NUMAR_TELEFON_CITITOR CHAR(10),
    EMAIL_CITITOR VARCHAR2(50),
    
    CONSTRAINT PK_CITITOR PRIMARY KEY(ID_CITITOR),
    CONSTRAINT U_NUME_PRENUME_CITITOR UNIQUE(NUME_CITITOR, PRENUME_CITITOR)
);


CREATE TABLE CARTE_AUTOR (
    ID_CARTE_AUTOR NUMBER(6),
    ID_CARTE NUMBER(5) NOT NULL,
    ID_AUTOR NUMBER(4) NOT NULL,    
    
    CONSTRAINT PK_CARTE_AUTOR PRIMARY KEY (ID_CARTE_AUTOR),
    CONSTRAINT U_ID_CARTE_AUTOR UNIQUE (ID_CARTE, ID_AUTOR),
    CONSTRAINT FK_AUTOR FOREIGN KEY (ID_AUTOR) REFERENCES AUTOR (ID_AUTOR) ON DELETE CASCADE,
    CONSTRAINT FK_CARTE_AUTOR FOREIGN KEY (ID_CARTE) REFERENCES CARTE (ID_CARTE) ON DELETE CASCADE
);



CREATE TABLE CARTE_CATEGORIE (
    ID_CARTE_CATEGORIE NUMBER(6),
    ID_CARTE NUMBER(5) NOT NULL,
    ID_CATEGORIE NUMBER(3) NOT NULL,    
    
    CONSTRAINT PK_CARTE_CATEGORIE PRIMARY KEY (ID_CARTE_CATEGORIE),
    CONSTRAINT U_ID_CARTE_CATEGORIE UNIQUE (ID_CARTE, ID_CATEGORIE),
    CONSTRAINT FK_CATEGORIE FOREIGN KEY (ID_CATEGORIE) REFERENCES CATEGORIE (ID_CATEGORIE) ON DELETE CASCADE,
    CONSTRAINT FK_CARTE_CATEGORIE FOREIGN KEY (ID_CARTE) REFERENCES CARTE (ID_CARTE) ON DELETE CASCADE
);

CREATE TABLE EXEMPLAR_CARTE(
    ID_EXEMPLAR NUMBER(6),
    ID_CARTE NUMBER(5) NOT NULL,
    ID_EDITURA NUMBER(3),
    AN_PUBLICATIE NUMBER(4),
    
    CONSTRAINT PK_EXEMPLAR_CARTE PRIMARY KEY(ID_EXEMPLAR),
    CONSTRAINT FK_EXEMPLAR_CARTE_CARTE FOREIGN KEY(ID_CARTE) REFERENCES CARTE(ID_CARTE),
    CONSTRAINT FK_EXEMPLAR_CARTE_EDITURA FOREIGN KEY(ID_EDITURA) REFERENCES EDITURA(ID_EDITURA) ON DELETE SET NULL
);

CREATE TABLE INFO_IMPRUMUT(
    ID_IMPRUMUT NUMBER(7),
    ID_EXEMPLAR NUMBER(6) NOT NULL,
    ID_CITITOR NUMBER(6) NOT NULL,
    ID_BIBLIOTECAR NUMBER(3) NOT NULL,
    DATA_IMPRUMUT DATE DEFAULT SYSDATE NOT NULL, 
    DATA_RETUR DATE,
    
    CONSTRAINT PK_IMPRUMUT PRIMARY KEY(ID_IMPRUMUT),
    CONSTRAINT FK_IMPRUMUT_EXEMPLAR FOREIGN KEY(ID_EXEMPLAR) REFERENCES EXEMPLAR_CARTE(ID_EXEMPLAR),
    CONSTRAINT FK_IMPRUMUT_CITITOR FOREIGN KEY(ID_CITITOR) REFERENCES CITITOR(ID_CITITOR),
    CONSTRAINT FK_IMPRUMUT_BIBLIOTECAR FOREIGN KEY(ID_BIBLIOTECAR) REFERENCES BIBLIOTECAR(ID_BIBLIOTECAR) ON DELETE SET NULL
);
CREATE TABLE CARTE_CITITOR (
    ID_CARTE_CITITOR NUMBER(7),
    ID_EXEMPLAR NUMBER(6) NOT NULL,
    ID_CITITOR NUMBER(6) NOT NULL,
    ID_IMPRUMUT NUMBER(7) NOT NULL,
    
    CONSTRAINT PK_CARTE_CITITOR PRIMARY KEY (ID_CARTE_CITITOR),
    CONSTRAINT FK_CITITOR_CARTE FOREIGN KEY (ID_CITITOR) REFERENCES CITITOR (ID_CITITOR) ,
    CONSTRAINT FK_CARTE_CITITOR FOREIGN KEY (ID_EXEMPLAR) REFERENCES EXEMPLAR_CARTE (ID_EXEMPLAR),
    CONSTRAINT FK_CARTE_CITITOR_IMPRUMUT FOREIGN KEY(ID_IMPRUMUT) REFERENCES INFO_IMPRUMUT(ID_IMPRUMUT),
    CONSTRAINT U_ID_IMPRUMUT UNIQUE(ID_IMPRUMUT)
);
DROP TABLE CARTE_CITITOR;